(function(k,h,m,l){var i={},j={};function n(){var c;try{c=navigator.plugins["Shockwave Flash"];c=c.description}catch(a){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(b){c="0.0"}}c=c.match(/\d+/g);return parseFloat(c[0]+"."+c[1])}m.flash={trigger:function(a,c,b){setTimeout(function(){var d=i[a],e,f;if(d){d.trigger("Flash:"+c,b)}},0)}};m.runtimes.Flash=m.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,maxWidth:8091,maxHeight:8091,chunks:true,progress:true,multipart:true,multi_selection:true}},init:function(a,g){var c,b,f=0,e=h.body;if(n()<10){g({success:false});return}j[a.id]=false;i[a.id]=a;c=h.getElementById(a.settings.browse_button);b=h.createElement("div");b.id=a.id+"_flash_container";m.extend(b.style,{position:"absolute",top:"0px",background:a.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});b.className="plupload flash";if(a.settings.container){e=h.getElementById(a.settings.container);if(m.getStyle(e,"position")==="static"){e.style.position="relative"}}e.appendChild(b);(function(){var r,o;r='<object id="'+a.id+'_flash" type="application/x-shockwave-flash" data="'+a.settings.flash_swf_url+'" ';if(m.ua.ie){r+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}r+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(a.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(m.ua.ie){o=h.createElement("div");b.appendChild(o);o.outerHTML=r;o=null}else{b.innerHTML=r}}());function p(){return h.getElementById(a.id+"_flash")}function d(){if(f++>5000){g({success:false});return}if(j[a.id]===false){setTimeout(d,1)}}d();c=b=null;a.bind("Destroy",function(r){var o;m.removeAllEvents(h.body,r.id);delete j[r.id];delete i[r.id];o=h.getElementById(r.id+"_flash_container");if(o){o.parentNode.removeChild(o)}});a.bind("Flash:Init",function(){var o={},s;try{p().setFileFilters(a.settings.filters,a.settings.multi_selection)}catch(t){g({success:false});return}if(j[a.id]){return}j[a.id]=true;a.bind("UploadFile",function(x,r){var q=x.settings,w=a.settings.resize||{};p().uploadFile(o[r.id],q.url,{name:r.target_name||r.name,mime:m.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:q.chunk_size,width:w.width,height:w.height,quality:w.quality,multipart:q.multipart,multipart_params:q.multipart_params||{},file_data_name:q.file_data_name,format:/\.(jpg|jpeg)$/i.test(r.name)?"jpg":"png",headers:q.headers,urlstream_upload:q.urlstream_upload})});a.bind("CancelUpload",function(){p().cancelUpload()});a.bind("Flash:UploadProcess",function(r,v){var q=r.getFile(o[v.id]);if(q.status!=m.FAILED){q.loaded=v.loaded;q.size=v.size;r.trigger("UploadProgress",q)}});a.bind("Flash:UploadChunkComplete",function(x,r){var q,w=x.getFile(o[r.id]);q={chunk:r.chunk,chunks:r.chunks,response:r.text};x.trigger("ChunkUploaded",w,q);if(w.status!==m.FAILED&&x.state!==m.STOPPED){p().uploadNextChunk()}if(r.chunk==r.chunks-1){w.status=m.DONE;x.trigger("FileUploaded",w,{response:r.text})}});a.bind("Flash:SelectFiles",function(B,y){var z,A,r=[],q;for(A=0;A<y.length;A++){z=y[A];q=m.guid();o[q]=z.id;o[z.id]=q;r.push(new m.File(q,z.name,z.size))}if(r.length){a.trigger("FilesAdded",r)}});a.bind("Flash:SecurityError",function(r,q){a.trigger("Error",{code:m.SECURITY_ERROR,message:m.translate("Security error."),details:q.message,file:a.getFile(o[q.id])})});a.bind("Flash:GenericError",function(r,q){a.trigger("Error",{code:m.GENERIC_ERROR,message:m.translate("Generic error."),details:q.message,file:a.getFile(o[q.id])})});a.bind("Flash:IOError",function(r,q){a.trigger("Error",{code:m.IO_ERROR,message:m.translate("IO error."),details:q.message,file:a.getFile(o[q.id])})});a.bind("Flash:ImageError",function(r,q){a.trigger("Error",{code:parseInt(q.code,10),message:m.translate("Image error."),file:a.getFile(o[q.id])})});a.bind("Flash:StageEvent:rollOver",function(v){var r,q;r=h.getElementById(a.settings.browse_button);q=v.settings.browse_button_hover;if(r&&q){m.addClass(r,q)}});a.bind("Flash:StageEvent:rollOut",function(v){var r,q;r=h.getElementById(a.settings.browse_button);q=v.settings.browse_button_hover;if(r&&q){m.removeClass(r,q)}});a.bind("Flash:StageEvent:mouseDown",function(v){var r,q;r=h.getElementById(a.settings.browse_button);q=v.settings.browse_button_active;if(r&&q){m.addClass(r,q);m.addEvent(h.body,"mouseup",function(){m.removeClass(r,q)},v.id)}});a.bind("Flash:StageEvent:mouseUp",function(v){var r,q;r=h.getElementById(a.settings.browse_button);q=v.settings.browse_button_active;if(r&&q){m.removeClass(r,q)}});a.bind("Flash:ExifData",function(r,q){a.trigger("ExifData",a.getFile(o[q.id]),q.data)});a.bind("Flash:GpsData",function(r,q){a.trigger("GpsData",a.getFile(o[q.id]),q.data)});a.bind("QueueChanged",function(q){a.refresh()});a.bind("FilesRemoved",function(v,q){var r;for(r=0;r<q.length;r++){p().removeFile(o[q[r].id])}});a.bind("StateChanged",function(q){a.refresh()});a.bind("Refresh",function(x){var w,r,q;p().setFileFilters(a.settings.filters,a.settings.multi_selection);w=h.getElementById(x.settings.browse_button);if(w){r=m.getPos(w,h.getElementById(x.settings.container));q=m.getSize(w);m.extend(h.getElementById(x.id+"_flash_container").style,{top:r.y+"px",left:r.x+"px",width:q.w+"px",height:q.h+"px"})}});a.bind("DisableBrowse",function(r,q){p().disableBrowse(q)});g({success:true})})}})})(window,document,plupload);