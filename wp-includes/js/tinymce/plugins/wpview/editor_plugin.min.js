!function(){var e,d=tinymce.VK,f=tinymce.dom.TreeWalker;tinymce.create("tinymce.plugins.wpView",{init:function(b){var a=this;"undefined"!=typeof wp&&wp.mce&&(b.onPreInit.add(function(c){c.schema.addValidElements("div[*],span[*]")}),b.onBeforeSetContent.add(function(g,c){c.content&&(c.content=wp.mce.view.toViews(c.content))}),b.onSetContent.add(function(c){wp.mce.view.render(c.getDoc())}),b.onInit.add(function(c){c.selection.onBeforeSetContent.add(function(h){var k,j,i=a.getParentView(h.getNode());i&&(!i.nextSibling||a.isView(i.nextSibling)?(j=c.getDoc().createTextNode(""),c.dom.insertAfter(j,i)):(k=new f(i.nextSibling,i.nextSibling),j=k.next()),h.select(j),h.collapse(!0))}),c.selection.onSetContent.add(function(h,g){if(g.context){var i=h.getNode();i.innerHTML&&(i.innerHTML=wp.mce.view.toViews(i.innerHTML),wp.mce.view.render(i))}})}),b.onPostProcess.add(function(g,c){(c.get||c.save)&&c.content&&(c.content=wp.mce.view.toText(c.content))}),b.onNodeChange.addToTop(function(h,g,j){var i=a.getParentView(j);return i?(a.select(i),!1):(a.deselect(),void 0)}),b.onKeyDown.addToTop(function(m,l){var k,j,i=l.keyCode;if(e){if(k=a.getParentView(m.selection.getNode()),k!==e){return a.deselect(),void 0}(i===d.DELETE||i===d.BACKSPACE)&&(j=wp.mce.view.instance(e))&&(j.remove(),a.deselect()),l.metaKey||l.ctrlKey||i>=112&&123>=i||l.preventDefault()}}))},getParentView:function(b){for(;b;){if(this.isView(b)){return b}b=b.parentNode}},isView:function(b){return/(?:^|\s)wp-view-wrap(?:\s|$)/.test(b.className)},select:function(a){a!==e&&(this.deselect(),e=a,wp.mce.view.select(e))},deselect:function(){e&&wp.mce.view.deselect(e),e=null},getInfo:function(){return{longname:"WordPress Views",author:"WordPress",authorurl:"http://wordpress.org",infourl:"http://wordpress.org",version:"1.0"}}}),tinymce.PluginManager.add("wpview",tinymce.plugins.wpView)}();